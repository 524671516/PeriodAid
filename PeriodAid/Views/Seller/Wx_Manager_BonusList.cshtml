
@{
    ViewBag.Title = "Wx_Manager_BonusList";
    Layout = "~/Views/Seller/_Wx_Manager_Layout.cshtml";
    ViewBag.Current = 2;
}

<div id="bonuslist"></div><br />
<div class="container">
    <button onclick ="open_confirm();" class="weui_btn weui_btn_primary weui_btn_disabled" disabled >确认红包并发放</button>
    <button onclick="open_dismiss();" class="weui_btn weui_btn_warn weui_btn_disabled" disabled>驳回红包</button>
    <a href="/Seller/Wx_Manager_Tools" class="weui_btn weui_btn_default">
        返回首页
    </a>
</div>
<div class="weui_dialog_confirm" id="dismiss_dialog" style="display:none;">
    <div class="weui_mask"></div>
    <div class="weui_dialog">
        <div class="weui_dialog_hd"><strong class="weui_dialog_title">提示</strong></div>
        <div class="weui_dialog_bd">是否要驳回选中的红包申请</div>
        <div class="weui_dialog_ft">
            <a href="javascript:cancel_dialog();" class="weui_btn_dialog default">取消</a>
            <a href="javascript:dismissBonus();" class="weui_btn_dialog primary">确定</a>
        </div>
    </div>
</div>
<div class="weui_dialog_confirm" id="confirm_dialog" style="display:none;">
    <div class="weui_mask"></div>
    <div class="weui_dialog">
        <div class="weui_dialog_hd"><strong class="weui_dialog_title">提示</strong></div>
        <div class="weui_dialog_bd">是否确认红包并发放红包申请</div>
        <div class="weui_dialog_ft">
            <a href="javascript:cancel_dialog();" class="weui_btn_dialog default">取消</a>
            <a href="javascript:confirmBonus();" class="weui_btn_dialog primary">确定</a>
        </div>
    </div>
</div>
<div id="toast_success" style="display: none;">
    <div class="weui_mask_transparent"></div>
    <div class="weui_toast">
        <i class="weui_icon_toast"></i>
        <p class="weui_toast_content">已完成</p>
    </div>
</div>
<br /><br />
@section scripts{
    <script>
        $(function () {
            $.ajax({
                url: "Wx_Manager_BonusList_Ajax",
                success: function (data) {
                    $("#bonuslist").html(data);
                }
            });
            $("#bonuslist").delegate(".weui_check", "change", function () {
                if ($(".weui_check:checked").length > 0) {
                    $("button.weui_btn").removeClass("weui_btn_disabled").removeAttr("disabled");
                }
                else {
                    $("button.weui_btn").addClass("weui_btn_disabled").attr("disabled");
                }
            });
        });
        function open_dismiss() {
            $("#dismiss_dialog").show();
        }
        function open_confirm() {
            $("#confirm_dialog").show();
        }
        function cancel_dialog() {
            $(".weui_dialog_confirm").hide();
        }
        function dismissBonus() {
            var id_Array = new Array();
            $(".weui_check:checked").each(function () {
                id_Array.push($(this).attr("id"));
            })
            $.ajax({
                url: "/Seller/Wx_Manager_BonusList_Dismiss",
                data: {
                    bonuslist: id_Array.toString()
                },
                type: "post",
                success: function (data) {
                    if (data.result == "SUCCESS") {
                        $("#toast_success").show();
                        setTimeout(function () {
                            $("#toast_success").hide();
                        }, 1000);
                        $.ajax({
                            url: "Wx_Manager_BonusList_Ajax",
                            success: function (data) {
                                $("#bonuslist").html(data);
                            }
                        });
                    }
                }
            });
            $("#dismiss_dialog").hide();
        }
        function confirmBonus() {
            var id_Array = new Array();
            $(".weui_check:checked").each(function () {
                id_Array.push($(this).attr("id"));
            })
            $.ajax({
                url: "/Seller/Wx_Manager_BonusList_Confirm",
                data: {
                    bonuslist: id_Array.toString()
                },
                type: "post",
                success: function (data) {
                    if (data.result == "SUCCESS") {
                        $("#toast_success").show();
                        setTimeout(function () {
                            $("#toast_success").hide();
                        }, 1000);
                        $.ajax({
                            url: "Wx_Manager_BonusList_Ajax",
                            success: function (data) {
                                $("#bonuslist").html(data);
                            }
                        });
                    }
                }
            });
            $("#confirm_dialog").hide();
        }
    </script>
    }
