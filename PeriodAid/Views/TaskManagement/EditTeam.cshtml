@model PeriodAid.Models.Employee
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title" id="Add-SubjectLabel">项目团队</h4>
    <input type="hidden" id="team_holder" value="@ViewBag.employee" />
    <input type="hidden" id="team_subject" value="@ViewBag.subject" />
</div>
<div class="modal-body">
    <div class="form-group">
        <div class="h5 edit-title"><i class="fa fa-user" aria-hidden="true"></i>&nbsp;团队成员：
            <span title="添加参与人" data-toggle="tooltip" data-placement="top"><a href="javascript:;" class="create_user_circle user_circle" id="add-employee" data-aid=""><i class="fa fa-plus ver_icon" aria-hidden="true"></i></a></span></div>
        <div class="clear-float" id="team_show">
            @foreach (var emb in ViewBag.AttendList2)
            {
                <div class="menu-attend-item" data-aid="@emb.Id" title="@emb.NickName" data-toggle="tooltip" data-placement="top">
                    <ul class="participator_area clear-float">
                        @if (emb.ImgUrl == null)
                        {
                            <li>
                                <div style="background-image: url('../../Content/images/defaultphoto.gif');" class="user_circle">
                                </div>
                            </li>
                        }
                        else
                        {
                            <li>
                                <div style="background-image: url('http://cdn2.shouquanzhai.cn/@emb.ImgUrl');" class="user_circle">
                                </div>
                            </li>
                        }
                    </ul>
                </div>
            }
            @foreach (var emp in ViewBag.AttendList1)
            {
                <div class="menu-attend-item" data-aid="@emp.Id" title="@emp.NickName" data-toggle="tooltip" data-placement="top">
                    <ul class="participator_area clear-float">
                    @if (emp.ImgUrl == null)
                    {
                        <li>
                            <div style="background-image: url('../../Content/images/defaultphoto.gif');" class="user_circle">
                                <div class="minus-icon"><i class="fa fa-minus" aria-hidden="true"></i></div>
                            </div>
                        </li>
                    }
                    else
                    {
                        <li>
                            <div style="background-image: url('http://cdn2.shouquanzhai.cn/@emp.ImgUrl');" class="user_circle">
                                <div class="minus-icon"><i class="fa fa-minus" aria-hidden="true"></i></div>
                            </div>
                        </li>
                    }
                    </ul>
                </div>
            }
        </div>
    </div>
    <div class="h5 edit-title text-center">
        <i class="fa fa-exclamation-triangle" aria-hidden="true"></i><span class="color-orange">点击+添加人员，点击人员头像移除人员。</span>
    </div>
</div>
<script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    });

    //添加参与者按钮事件
    $("#add-employee").on("click", function () {
        //获取增加参与人模板
        $.ajax({
            url: "/TaskManagement/Subject_CollaboratorAddPartial",
            type: "post",
            data: {
                employee: $("#team_holder").val(),
                subject: $("#team_subject").val()
            },
            success: function (data) {
                $("#Add-Team .modal-content").html(data);
                $('#Add-Team').modal('show');
            }
        })
    });
    //删除参与者按钮事件
    $(".minus-icon").on("click", function () {
        var that = $(this);
        _data = {
            SubjectId: $("#team_subject").val(),
            EmployeeId: that.parent().parent().parent().parent().attr("data-aid")
        }
        CustomConfirm("是否要删除此联系人?", function () {
            EditForAjax("/TaskManagement/DeleteTeamCollaborator", _data, function (data) {
                //成功
                //获取参与人模板
                that.parent().parent().parent().parent().remove();
                var EmployeeId = '"'+that.parent().parent().parent().parent().attr("data-aid")+'"';
                $("#menu_team_show div[data-aid=" + EmployeeId + "]").remove();
            }, function (data) {
                //失败
            })
        })
    })
</script>