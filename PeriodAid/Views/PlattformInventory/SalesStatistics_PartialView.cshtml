@model PagedList.IPagedList<PeriodAid.Models.SS_SalesStatistic>
@using PagedList.Mvc;
<table class="table table-hover">
    <thead>
        <tr>
            <th>系统编码</th>
            <th>产品名称</th>
            <th><a href="#" style="display:inline-block;width:100%;height:100%;position:relative" class="sales_sort" data-val="1">前1天销量<i class="fa sort_i active" data-sort="dec" style="position:absolute;right:0;top:2px"></i></a></th>
            <th><a href="#" style="display:inline-block;width:100%;height:100%;position:relative" class="sales_sort" data-val="2">近7天销量<i class="fa sort_i" data-sort="dec"  style="position:absolute;right:0;top:2px"></i></a></th>
            <th><a href="#" style="display:inline-block;width:100%;height:100%;position:relative" class="sales_sort" data-val="3">前7天销量<i class="fa sort_i" data-sort="dec"  style="position:absolute;right:0;top:2px"></i></a></th>
            <th>增比</th>
            <th></th>
        </tr>
    </thead>
    <tbody id="sort_partialView">
    </tbody>
</table>
    <div class="text-right">@Html.PagedListPager(Model, page => Url.Action("SalesStatisticsSort_PartialView", new { page }))</div>
<script>
    //页码
    $(".pagination > li > a").click(function () {
        var l = $(this).attr("href");
        $(".pagination > li").removeClass("active")
        $(this).parent("li").addClass("active")
        $.ajax({
            url: l,
            data: {
                plattformId: $("#ul_view").children(".active").children(".shop_select").attr("data-id"),
                query: $("#sales_product_query").val(),
                sortVal: $(".sales_sort").children(".active").attr("data-sort")
            },
            success: function (data) {
                $("#sort_partialView").html(data);
            }
        });
        return false;
    });
    $(function () {
        $.ajax({
            url: "/PlattformInventory/SalesStatisticsSort_PartialView",
            data: {
                plattformId: $("#ul_view").children(".active").children(".shop_select").attr("data-id"),
                query: $("#sales_product_query").val(),
                sortVal: $(".sales_sort").children(".active").attr("data-sort")
            },
            success: function (data) {
                $("#sort_partialView").html(data)
            }
        })
    })
    // 排序
    $(".sales_sort").on("click", function () {
        var that = $(this)
        $(".sales_sort").children(".sort_i").removeClass("active fa-arrow-up color-red")
        that.children(".sort_i").addClass("active fa-arrow-up color-red")
        //if (!that.children(".active").hasClass("fa-arrow-up")) {
        //    that.children(".active").attr("data-sort", "asc")
        //    that.children(".active").removeClass("fa-arrow-down")
        //    that.children(".active").removeClass("color-blue")
        //    that.children(".active").addClass("fa-arrow-up")
        //    that.children(".active").addClass("color-red")
        //    //$.ajax({
        //    //    url: "/PlattformInventory/SalesStatisticsSort_PartialView",
        //    //    data: {
        //    //        plattformId: $("#ul_view").children(".active").children(".shop_select").attr("data-id"),
        //    //        query: $("#sales_product_query").val(),
        //    //        sortVal: that.children(".active").attr("data-sort")
        //    //    },
        //    //    success: function (data) {
        //    //        $("#sort_partialView").html(data)
        //    //    }
        //    //})
        //}
        //else {
        //    that.children(".active").attr("data-sort", "dec")
        //    that.children(".active").removeClass("fa-arrow-up")
        //    that.children(".active").removeClass("color-red")
        //    that.children(".active").addClass("fa-arrow-down")
        //    that.children(".active").addClass("color-blue")
        //    //$.ajax({
        //    //    url: "/PlattformInventory/SalesStatisticsSort_PartialView",
        //    //    data: {
        //    //        plattformId: $("#ul_view").children(".active").children(".shop_select").attr("data-id"),
        //    //        query: $("#sales_product_query").val(),
        //    //        sortVal: that.children(".active").attr("data-sort")
        //    //    },
        //    //    success: function (data) {
        //    //        $("#sort_partialView").html(data)
        //    //    }
        //    //})
        //}
        return false;
    })
    // 来源分析
    $(".JD-Traffic").on("click", function () {
        var product_Id = $(this).attr('data-val')
        var product_Name = $(this).attr("data-name")
        $(this).attr("href", "TrafficList?plattformId=" + getUrlParam('plattformId') + "&productId=" + product_Id)
    })
</script>