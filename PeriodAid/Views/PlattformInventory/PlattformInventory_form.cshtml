@model IEnumerable<PeriodAid.Models.Product_SummaryViewModel>
@{
    Layout = "~/Views/Shared/_PlattformInventory.cshtml";

}
@section header{
    <link href="~/Content/jquery-ui.min.css" rel="stylesheet" />
    <style>
        div {
            z-index: 52;
        }
    </style>
}
<div class="navbar-default tm_task-navbar" style="padding-top:10px">
    <div id="nav-table-show">
        <!-- Nav tabs -->
        <ul class="nav nav-tabs nav-pills" role="tablist" style="font-size:14px">
            <li role="presentation" class="form-select-li active all-form-select"><a href="#" role="tab" data-toggle="tab" class="form-select-a">所有仓库</a></li>
            @foreach (var item in ViewBag.storage)
            {
                <li role="presentation" class="form-select-li" style="margin-top:1px"><a href="#" role="tab" data-toggle="tab" data-ssid="@item.Id" class="form-select-a" style="margin-right:0">@item.Storage_Name</a></li>
            }
        </ul>
    </div>
    <div style="padding:20px 0;">

        <div class="text-center h2">每日数据</div>
    </div>
    <div class="form-view-header clear-float">
        <div>
            <div class="tm-view-control">
                <ul class="nav nav-pills" style="float:right">
                    <li class="tm-view-control-sort dropdown" style="position:relative">
                        <a data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" style="cursor:pointer">
                            <span class="tm-select-title" id="form-date-select" style="font-size:14px">选择日期</span>
                            <input type="text" id="file-date" name="file-date" style="height: 48px;position:absolute;left: 0;width: 97px;top: 0;cursor:pointer;opacity:0" />
                            <span class="caret"></span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div id="storage_show">
        <div class="center-block" id="my-form-content">
            <!-- Tab panes -->
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active">
                    <table class="table table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>产品编号</th>
                                <th>商品编号</th>
                                <th>商品名称</th>
                                <th>销售数据</th>
                                <th>仓库库存</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                <tr>
                                    <th scope="row">@item.Product.System_Code</th>
                                    <td></td>
                                    <td><a data-href="#" data-pid="@item.Product.Id" style="cursor:pointer">@item.Product.Item_Name</a></td>
                                    <td>@item.Sales_Sum</td>
                                    <td>@item.Inventory_Sum</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts{

    <script>
    // 初始化数据
    $(function () {
        //日期格式改变
        $("#file-date").datepicker({ dateFormat: "yy-mm-dd" });
        //星期格式汉化
        $("#file-date").datepicker("option", "dayNamesMin", ["日", "一", "二", "三", "四", "五", "六"]);
        //月份格式汉化
        $("#file-date").datepicker("option", "monthNames", ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"]);
        $("#file-date").datepicker();
        $.ajax({

                url: "/PlattformInventory/PlattformInventory_form/",
                data: {

                },
                success: function (data) {

                }
        })
        // tab 切换
        $("#nav-table-show ul li").on("click", function () {
            var that = $(this);
            if (that.hasClass('all-form-select')) {
                $.ajax({
                    url: "/PlattformInventory/PlattformInventory_form/",
                    data: {

                    },
                    success: function (data) {
                        window.location.href = '/PlattformInventory/PlattformInventory_form/'
                    }
                })
            } else {
                $.ajax({
                    url: "/PlattformInventory/StorageShow/",
                    data: {
                        Storage: that.children('.form-select-a').attr('data-ssid')
                    },
                    success: function (data) {
                        that.children('.form-select-a').addClass("active");
                        $("#storage_show").html(data);
                    }
                })
            }
        })
        // 选择日期
        $('#file-date').change(function () {
            
            console.log($(this).val())
            $('#form-date-select').text($(this).val())
            console.log($('#form-date-select').text())
            $.ajax({
                url: '/PlattformInventory/StorageShow/',
                type:'post',
                data: {
                    Storage:1,
                    select_date: $('#form-date-select').text()
                },
                success: function (data) {
                    console.log(data)
                    $('#storage_show').html(data)
                }
            })
        })
    })

    </script>
}